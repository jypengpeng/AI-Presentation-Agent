# å¹»ç¯ç‰‡ç›‘æ§ä¸ç¼–è¾‘ç•Œé¢è®¾è®¡æ–¹æ¡ˆ

## æ¦‚è¿°

è®¾è®¡ä¸€ä¸ªå…¨æ–°çš„å…¨å±ç½‘æ ¼è§†å›¾ç•Œé¢ï¼Œç”¨äºç›‘æ§ Designer Agent çš„å¹¶å‘ç”Ÿæˆè¿›åº¦ï¼Œä»¥åŠæ”¯æŒç”¨æˆ·å¯¹å•ä¸ªå¹»ç¯ç‰‡è¿›è¡Œé¢„è§ˆå’Œä¿®æ”¹ã€‚

## è®¾è®¡å†³ç­–æ€»ç»“

| å†³ç­–é¡¹ | é€‰æ‹© |
|--------|------|
| æ•´ä½“å¸ƒå±€ | å…¨å±ç½‘æ ¼è§†å›¾ï¼ˆç±»ä¼¼çœ‹æ¿ï¼‰ |
| å¡ç‰‡äº¤äº’ | åŸåœ°å±•å¼€ï¼ˆæ‰‹é£ç´æ•ˆæœï¼‰ |
| å±•å¼€å†…å®¹ | å·¦å³åˆ†æ ï¼šé¢„è§ˆ + ç¼–è¾‘åŒº |
| é¡µé¢ç»„ç»‡ | åˆ†é˜¶æ®µå•å‘æµç¨‹ |
| è¿›åº¦åˆ·æ–° | è‡ªåŠ¨å®šæ—¶åˆ·æ–°ï¼ˆ2-3ç§’ï¼‰ |

---

## ç”¨æˆ·æµç¨‹

```mermaid
flowchart LR
    A[å¯¹è¯é˜¶æ®µ] --> B[JSON ç¼–è¾‘é˜¶æ®µ]
    B --> C[ç½‘æ ¼ç›‘æ§/ç¼–è¾‘é˜¶æ®µ]
    C --> D[å¯¼å‡º]
    C --> E[é‡æ–°å¼€å§‹]
    E --> A
```

### é˜¶æ®µè¯´æ˜

1. **å¯¹è¯é˜¶æ®µ** (`collecting` / `architect`)
   - ä¿æŒç°æœ‰èŠå¤©ç•Œé¢
   - ç”¨æˆ·ä¸ Agent å¯¹è¯æ”¶é›†ä¿¡æ¯
   - Architect ç”Ÿæˆæ¼”ç¤ºæ–‡ç¨¿è§„åˆ’

2. **JSON ç¼–è¾‘é˜¶æ®µ** (`editing_plan`)
   - æ˜¾ç¤º JSON ç¼–è¾‘å™¨
   - ç”¨æˆ·æ£€æŸ¥/ä¿®æ”¹æ¼”ç¤ºæ–‡ç¨¿è§„åˆ’
   - ç¡®è®¤åè¿›å…¥ç”Ÿæˆé˜¶æ®µ

3. **ç½‘æ ¼ç›‘æ§/ç¼–è¾‘é˜¶æ®µ** (`designing` / `completed`)
   - å…¨å±ç½‘æ ¼è§†å›¾
   - å®æ—¶ç›‘æ§ç”Ÿæˆè¿›åº¦
   - ç‚¹å‡»å¡ç‰‡å±•å¼€ç¼–è¾‘

---

## ç½‘æ ¼è§†å›¾è®¾è®¡

### æ•´ä½“å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š å¹»ç¯ç‰‡ç”Ÿæˆç›‘æ§                    [3/10 å®Œæˆ] [â– â– â– â–‘â–‘â–‘â–‘â–‘â–‘â–‘]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ Slide 1 â”‚  â”‚ Slide 2 â”‚  â”‚ Slide 3 â”‚  â”‚ Slide 4 â”‚            â”‚
â”‚  â”‚  âœ…     â”‚  â”‚  âœ…     â”‚  â”‚  ğŸ”„     â”‚  â”‚  â³     â”‚            â”‚
â”‚  â”‚ [ç¼©ç•¥å›¾]â”‚  â”‚ [ç¼©ç•¥å›¾]â”‚  â”‚ [åŠ è½½ä¸­]â”‚  â”‚ [ç­‰å¾…ä¸­]â”‚            â”‚
â”‚  â”‚ æ ‡é¢˜é¡µ  â”‚  â”‚ ç›®å½•    â”‚  â”‚ æ•°æ®æ¦‚è§ˆâ”‚  â”‚ è¶‹åŠ¿åˆ†æâ”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ Slide 5 â”‚  â”‚ Slide 6 â”‚  â”‚ Slide 7 â”‚  â”‚ Slide 8 â”‚            â”‚
â”‚  â”‚  â³     â”‚  â”‚  â³     â”‚  â”‚  â³     â”‚  â”‚  â³     â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ğŸ“¦ å¯¼å‡ºä¸ºå•æ–‡ä»¶]                          [ğŸ”„ é‡æ–°å¼€å§‹]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¡ç‰‡çŠ¶æ€

| çŠ¶æ€ | å›¾æ ‡ | èƒŒæ™¯è‰² | è¯´æ˜ |
|------|------|--------|------|
| pending | â³ | ç°è‰² | ç­‰å¾…ç”Ÿæˆ |
| generating | ğŸ”„ | è“è‰²è„‰å†² | æ­£åœ¨ç”Ÿæˆ |
| completed | âœ… | ç»¿è‰² | ç”ŸæˆæˆåŠŸ |
| failed | âŒ | çº¢è‰² | ç”Ÿæˆå¤±è´¥ |
| modified | âœï¸ | æ©™è‰² | ç”¨æˆ·å·²ä¿®æ”¹ |

### å¡ç‰‡å†…å®¹

æ¯ä¸ªå¡ç‰‡åŒ…å«ï¼š
- **çŠ¶æ€å›¾æ ‡**ï¼šå³ä¸Šè§’æ˜¾ç¤º
- **ç¼©ç•¥å›¾åŒºåŸŸ**ï¼š
  - pending/generatingï¼šæ˜¾ç¤ºå ä½ç¬¦æˆ–åŠ è½½åŠ¨ç”»
  - completedï¼šæ˜¾ç¤º iframe æ¸²æŸ“çš„ç¼©ç•¥é¢„è§ˆ
  - failedï¼šæ˜¾ç¤ºé”™è¯¯æç¤º
- **æ ‡é¢˜**ï¼šslide çš„ title
- **ç±»å‹æ ‡ç­¾**ï¼šå¦‚ `title`, `bullet_list`, `chart`

---

## å±•å¼€è§†å›¾è®¾è®¡

ç‚¹å‡»å¡ç‰‡åï¼Œè¯¥å¡ç‰‡åŸåœ°å±•å¼€ï¼Œå…¶ä»–å¡ç‰‡æ”¶ç¼©åˆ°æœ€å°æˆ–éšè—ã€‚

### å±•å¼€å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† è¿”å›ç½‘æ ¼è§†å›¾                              Slide 3 / 10      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                           â”‚  â”‚  ğŸ“ ä¿®æ”¹æ­¤å¹»ç¯ç‰‡            â”‚â”‚
â”‚  â”‚                           â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚                           â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚
â”‚  â”‚      [iframe é¢„è§ˆ]        â”‚  â”‚  â”‚ è¯·æè¿°æ‚¨æƒ³è¦çš„ä¿®æ”¹...   â”‚â”‚â”‚
â”‚  â”‚                           â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚
â”‚  â”‚                           â”‚  â”‚  [ğŸ”„ åº”ç”¨ä¿®æ”¹]              â”‚â”‚
â”‚  â”‚                           â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚                           â”‚  â”‚  ğŸ“‹ JSON é…ç½®               â”‚â”‚
â”‚  â”‚                           â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚
â”‚  â”‚                           â”‚  â”‚  â”‚ {                       â”‚â”‚â”‚
â”‚  â”‚                           â”‚  â”‚  â”‚   "id": "slide_3",     â”‚â”‚â”‚
â”‚  â”‚                           â”‚  â”‚  â”‚   "type": "chart",     â”‚â”‚â”‚
â”‚  â”‚                           â”‚  â”‚  â”‚   ...                   â”‚â”‚â”‚
â”‚  â”‚                           â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚
â”‚  â”‚                           â”‚  â”‚  [ğŸ’¾ ä¿å­˜ JSON]             â”‚â”‚
â”‚  â”‚                           â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚                           â”‚  â”‚  [ğŸ” é‡æ–°ç”Ÿæˆæ•´ä¸ªå¹»ç¯ç‰‡]    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [â† ä¸Šä¸€é¡µ]                                        [ä¸‹ä¸€é¡µ â†’]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å³ä¾§ç¼–è¾‘åŒºåŠŸèƒ½

1. **ä¿®æ”¹è¯·æ±‚è¾“å…¥æ¡†**
   - æ–‡æœ¬è¾“å…¥åŒºåŸŸ
   - ç”¨æˆ·æè¿°æƒ³è¦çš„ä¿®æ”¹
   - ç‚¹å‡»"åº”ç”¨ä¿®æ”¹"è°ƒç”¨ Designer Agent è¿›è¡Œä¿®æ”¹

2. **JSON ç¼–è¾‘å™¨**
   - æ˜¾ç¤ºå½“å‰ slide çš„ JSON é…ç½®
   - å¯æŠ˜å çš„ expander
   - ç”¨æˆ·å¯ç›´æ¥ç¼–è¾‘ JSON
   - ä¿å­˜åé‡æ–°ç”Ÿæˆ

3. **é‡æ–°ç”ŸæˆæŒ‰é’®**
   - ä½¿ç”¨åŸå§‹é…ç½®é‡æ–°ç”Ÿæˆæ•´ä¸ª slide

---

## è‡ªåŠ¨åˆ·æ–°æœºåˆ¶

### åˆ·æ–°ç­–ç•¥

```python
# ä¼ªä»£ç 
if current_phase == "designing":
    if has_pending_or_generating_slides():
        # æ¯ 2 ç§’åˆ·æ–°ä¸€æ¬¡
        time.sleep(2)
        st.rerun()
    else:
        # å…¨éƒ¨å®Œæˆï¼Œåœæ­¢è‡ªåŠ¨åˆ·æ–°
        current_phase = "completed"
```

### åˆ·æ–°è§¦å‘æ¡ä»¶

- å½“å‰é˜¶æ®µä¸º `designing`
- å­˜åœ¨ `pending` æˆ– `generating` çŠ¶æ€çš„ slide
- éå±•å¼€çŠ¶æ€ï¼ˆå±•å¼€ç¼–è¾‘æ—¶æš‚åœè‡ªåŠ¨åˆ·æ–°ï¼‰

---

## Session State æ–°å¢å˜é‡

```python
# ç½‘æ ¼è§†å›¾ç›¸å…³
st.session_state.grid_view_expanded_slide = None  # å½“å‰å±•å¼€çš„ slide id
st.session_state.last_refresh_time = None         # ä¸Šæ¬¡åˆ·æ–°æ—¶é—´
st.session_state.auto_refresh_enabled = True      # æ˜¯å¦å¯ç”¨è‡ªåŠ¨åˆ·æ–°

# é˜¶æ®µçŠ¶æ€
# current_phase å¯èƒ½çš„å€¼ï¼š
# - "collecting": æ”¶é›†ä¿¡æ¯é˜¶æ®µ
# - "architect": Architect è§„åˆ’é˜¶æ®µ  
# - "editing_plan": JSON ç¼–è¾‘é˜¶æ®µ
# - "designing": Designer ç”Ÿæˆé˜¶æ®µ
# - "completed": å…¨éƒ¨å®Œæˆ
```

---

## å®ç°ä»»åŠ¡åˆ†è§£

### Phase 1: åŸºç¡€ç½‘æ ¼è§†å›¾
- [ ] åˆ›å»º `render_grid_view()` å‡½æ•°
- [ ] å®ç°å¡ç‰‡æ¸²æŸ“é€»è¾‘
- [ ] ä» manifest.json è¯»å–çŠ¶æ€
- [ ] æ˜¾ç¤ºè¿›åº¦ç»Ÿè®¡

### Phase 2: è‡ªåŠ¨åˆ·æ–°
- [ ] å®ç°å®šæ—¶åˆ·æ–°é€»è¾‘
- [ ] æ·»åŠ åˆ·æ–°çŠ¶æ€æ£€æµ‹
- [ ] ç”Ÿæˆå®Œæˆååœæ­¢åˆ·æ–°

### Phase 3: å¡ç‰‡å±•å¼€
- [ ] å®ç°å±•å¼€/æ”¶èµ·é€»è¾‘
- [ ] å±•å¼€è§†å›¾çš„é¢„è§ˆ iframe
- [ ] ç¼–è¾‘åŒºåŸŸ UI

### Phase 4: ç¼–è¾‘åŠŸèƒ½
- [ ] ä¿®æ”¹è¯·æ±‚è¾“å…¥å’Œå¤„ç†
- [ ] JSON ç¼–è¾‘å’Œä¿å­˜
- [ ] é‡æ–°ç”Ÿæˆå•ä¸ª slide

### Phase 5: é¡µé¢å¯¼èˆª
- [ ] ä¿®æ”¹ main() å‡½æ•°è·¯ç”±é€»è¾‘
- [ ] æ ¹æ® current_phase æ¸²æŸ“ä¸åŒç•Œé¢
- [ ] æ·»åŠ è¿”å›/é‡æ–°å¼€å§‹æŒ‰é’®

---

## æŠ€æœ¯æ³¨æ„äº‹é¡¹

### Streamlit é™åˆ¶

1. **è‡ªåŠ¨åˆ·æ–°**ï¼šä½¿ç”¨ `time.sleep()` + `st.rerun()` å®ç°ï¼Œå¯èƒ½å¯¼è‡´è½»å¾®é—ªçƒ
2. **åŠ¨ç”»æ•ˆæœ**ï¼šStreamlit åŸç”Ÿä¸æ”¯æŒå¹³æ»‘åŠ¨ç”»ï¼Œå±•å¼€/æ”¶èµ·ä¸ºå³æ—¶åˆ‡æ¢
3. **iframe æ¸²æŸ“**ï¼šä½¿ç”¨ `st.components.v1.html()` æˆ– `st.components.v1.iframe()`

### å¹¶å‘å®‰å…¨

- manifest.json ä½œä¸ºçŠ¶æ€æº
- slide_generator åœ¨åå°çº¿ç¨‹/è¿›ç¨‹è¿è¡Œ
- å‰ç«¯åªè¯»å–çŠ¶æ€ï¼Œä¸ç›´æ¥ä¿®æ”¹ç”Ÿæˆè¿›ç¨‹

---

## ä¸‹ä¸€æ­¥

1. ç¡®è®¤æ­¤è®¾è®¡æ–¹æ¡ˆ
2. åˆ‡æ¢åˆ° Code æ¨¡å¼å¼€å§‹å®ç°
3. æŒ‰ Phase é€æ­¥å¼€å‘å’Œæµ‹è¯•